#!/usr/bin/env bash
# Show all running linux-voice-assistant instances

echo "Running linux-voice-assistant instances:"
echo "========================================="

# Find all processes running linux_voice_assistant
pids=$(pgrep -f "python.*linux_voice_assistant" || true)

if [ -z "$pids" ]; then
    echo "No running instances found."
    exit 0
fi

# Show detailed info for each process
for pid in $pids; do
    # Get full command line
    cmdline=$(ps -p "$pid" -o args= 2>/dev/null || echo "Unknown")
    
    # Extract name if present
    name=$(echo "$cmdline" | grep -oP '(?<=--name )[^ ]+' || echo "unknown")
    
    # Get start time and elapsed time
    start=$(ps -p "$pid" -o lstart= 2>/dev/null || echo "Unknown")
    elapsed=$(ps -p "$pid" -o etime= 2>/dev/null || echo "Unknown")
    
    echo ""
    echo "PID: $pid"
    echo "Name: $name"
    echo "Started: $start"
    echo "Uptime: $elapsed"
    echo "Command: $cmdline"
    echo "-----------------------------------------"
done

echo ""
echo "Total instances: $(echo "$pids" | wc -w)"
